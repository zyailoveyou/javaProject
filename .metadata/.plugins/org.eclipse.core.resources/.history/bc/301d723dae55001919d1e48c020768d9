package test1;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.TreeMap;
import java.util.TreeSet;

import jxl.Cell;
import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;
import jxl.write.Label;
import jxl.write.Number;
import jxl.write.WritableCell;
import jxl.write.WritableCellFeatures;
import jxl.write.WritableSheet;
import jxl.write.WritableWorkbook;
import jxl.write.WriteException;
import jxl.write.biff.RowsExceededException;

public class test1 {
	
	
	public static void main(String[] args) throws BiffException, IOException, WriteException {
		
		
		//创建需要读取基本统计数据的表单
		Workbook test1work = Workbook.getWorkbook(
				new File("C:\\Users\\Administrator\\Desktop\\workbooktest\\汇景一般销售.xls"));
		
		
		
		//创建需要统计的员工集合
		ArrayList<String> nameList = new ArrayList<String>();
		nameList.add("吴友兰");
		nameList.add("陈诚");
		nameList.add("杨易");
		Assess.setNameList(nameList);	
		
		
		//计算考勤天数和批注
		Assess.CaculationAssessActualDaysByPerson("吴有兰", test1work, "1231");			

		
		
		
		
		
		
		
		
		//测试代码用于将统计数据写入
		WritableWorkbook writetestworkbook = Workbook.createWorkbook(
				new File("C:\\Users\\Administrator\\Desktop\\workbooktest\\writeexcel.xls"));
		WritableSheet test1sheet = writetestworkbook.createSheet("test1", 0);
		
		HashMap<String,Integer> showday = Assess.getAssessDayInformation();

		for (int i = 0; i < Assess.getAssessDayInformation().size(); i++) {
	
			Number mNumber = new Number(i, 0, showday.get(i));	
			test1sheet.addCell(mNumber);
			
		}	
		
		
		    Label l = new Label(10, 0, "5555");
		    WritableCellFeatures cellFeatures = new WritableCellFeatures();
		    cellFeatures.setComment(Assess.getHalfdaynoclear_postil());
		    l.setCellFeatures(cellFeatures);
		    test1sheet.addCell(l);
		    
			writetestworkbook.write();
			writetestworkbook.close();
			
			TreeSet<String> good1 = new TreeSet<String>();
			
			good1.add("1231");
			

				

     }
	
}
