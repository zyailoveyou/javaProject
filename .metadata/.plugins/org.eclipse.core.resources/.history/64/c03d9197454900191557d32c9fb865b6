package graphic_zip;

import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;

public class filecompress {
	
	
	  public static String compressPic(String inputDir, 
			                           String outputDir,
			                           String inputFileName,
			                           String outputFileName) {    
		  
	        try {  

	            File file = new File(inputDir + inputFileName); 
	            
	            if(file.exists()){
	            	
//	            	if(minLength > file.length()) {
//	                    return inputFileName;  
//	                }  
	                  
	                Image img = ImageIO.read(file); 
	                
	                int newWidth = img.getWidth(null); 
	                
	                int newHeight = img.getHeight(null); 
	                
	                BufferedImage tag = new BufferedImage((int) newWidth, (int) newHeight, BufferedImage.TYPE_INT_RGB);  
	                
	                tag.getGraphics().drawImage(  
	                                img.getScaledInstance(newWidth, newHeight,  
	                                Image.SCALE_SMOOTH), 0, 0, null); 
	                /*FileOutputStream out = new FileOutputStream(outputDir + outputFileName);  
	                JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);  
	                encoder.encode(tag);
	                out.close();*/
	                
	                String dstName = outputDir + outputFileName;
	                
	                String formatName = dstName.substring(dstName.lastIndexOf(".") + 1);  
	                
	                
	                boolean whetherOK = false;
	                
	                whetherOK = ImageIO.write(tag, formatName, new File(dstName) /* target */ );  
	                  
	                System.out.println(whetherOK);
	                // 压缩完成后，删除源文件  
	                file.delete(); 
	            }
	            
	            
	            else{
	            	
	            	return "压缩文件不存在";
	            	
	            }
	            
	        } catch (IOException ex) {  
	        	System.out.println(ex);
	            ex.printStackTrace();  
	            return inputFileName;  
	        }  
	        
	        return outputFileName;  
	    }  


}
