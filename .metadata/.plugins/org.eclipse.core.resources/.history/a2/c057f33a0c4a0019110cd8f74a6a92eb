package graphic_zip;

import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;

import javax.imageio.ImageIO;

import com.sun.image.codec.jpeg.JPEGCodec;
import com.sun.image.codec.jpeg.JPEGEncodeParam;
import com.sun.image.codec.jpeg.JPEGImageEncoder;





public class filecompress {
	
	
	
	  public static String compressPic(String inputDir, 
			                           String outputDir,
			                           String inputFileName,
			                           String outputFileName) {    
		  
	        try {  

	            File file = new File(inputDir + inputFileName); 
	            
	            if(file.exists()){
	            	
//	            	if(minLength > file.length()) {
//	                    return inputFileName;  
//	                }  
	                  
	                Image img = ImageIO.read(file); 
	                
	                int newWidth = img.getWidth(null); 
	                
	                int newHeight = img.getHeight(null); 
	                
	                BufferedImage tag = new BufferedImage((int) newWidth, (int) newHeight, BufferedImage.TYPE_INT_RGB);  
	                
	                tag.getGraphics().drawImage(  
	                                img.getScaledInstance(newWidth, newHeight,  
	                                Image.SCALE_SMOOTH), 0, 0, null); 
	                
//	                FileOutputStream out = new FileOutputStream(outputDir + outputFileName);  
//	                JPEGImageEncoder encoder = JPEGCodec.createJPEGEncoder(out);  
//	                JPEGEncodeParam jep = JPEGCodec.getDefaultJPEGEncodeParam(tag);
//	                jep.setQuality(0.05f, true);
//	                
//	                encoder.encode(tag);
//	                out.close();\
	                
	                
	                
	                
	                String dstName = outputDir + outputFileName;
	                
	                String formatName = dstName.substring(dstName.lastIndexOf(".") + 1);  
	                
	                
	                boolean whetherOK = false;
	                
	                whetherOK = ImageIO.write(tag, formatName, new File(dstName));  
	                  
	                System.out.println("是否压缩成功"+whetherOK);
	              
//	                file.delete(); 
	                
	            }
	            
	            
	            else{
	            	
	            	return "压缩文件不存在";
	            	
	            }
	            
	        } catch (IOException ex) {  
	        	System.out.println(ex);
	            ex.printStackTrace();  
	            return inputFileName;  
	        }  
	        
	        return outputFileName;  
	    }  

	  
	  

}
